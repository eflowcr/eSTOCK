<div class="border rounded p-3 bg-white dark:bg-gray-800 text-center">
  <!-- Error State -->
  <div *ngIf="error()" class="text-red-600 dark:text-red-400">
    <div class="text-xs mb-2">{{ error() }}</div>
    <div *ngIf="name" class="text-xs mt-1 font-medium">{{ name }}</div>
    <div class="text-xs mt-1 font-mono">{{ code }}</div>
  </div>
  
  <!-- Loading State -->
  <div *ngIf="isLoading()" class="text-gray-500 dark:text-gray-400">
    <div class="flex items-center justify-center mb-2">
      <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"></div>
    </div>
    <div class="text-xs">{{ t('BARCODE.GENERATING') }}</div>
    <div *ngIf="name" class="text-xs mt-1 font-medium">{{ name }}</div>
    <div class="text-xs mt-1 font-mono">{{ code }}</div>
  </div>
  
  <!-- Success State -->
  <div *ngIf="!error() && !isLoading()" class="space-y-2">
    <!-- Canvas for generated barcodes -->
    <canvas 
      #barcodeCanvas 
      class="mx-auto max-w-full"
      [style.display]="showCanvas() ? 'block' : 'none'">
    </canvas>
    
    <!-- Fallback QR image for external service -->
    <img 
      *ngIf="!showCanvas() && type === 'qr' && fallbackQrUrl" 
      [src]="fallbackQrUrl"
      [alt]="t('BARCODE.ALT_TEXT')"
      class="mx-auto max-w-full h-auto rounded"
      (error)="onImageError()"
      (load)="onImageLoad()" />
    
    <!-- Fallback linear barcode representation -->
    <div *ngIf="!showCanvas() && type !== 'qr'" class="mx-auto">
      <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg">
        <div class="text-sm font-mono font-bold text-gray-900 dark:text-white mb-2">
          {{ displayCode() }}
        </div>
        <div class="text-xs text-gray-600 dark:text-gray-400">
          {{ type.toUpperCase() }}
        </div>
      </div>
    </div>
    
    <!-- Item name -->
    <div *ngIf="name" class="text-xs mt-2 font-medium text-gray-900 dark:text-white">{{ name }}</div>
    
    <!-- Display code -->
    <div class="text-xs mt-1 font-mono text-gray-500 dark:text-gray-400">{{ displayCode() }}</div>
  </div>
</div>
